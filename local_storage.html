<!DOCTYPE html>
<html lang="en">
<head>
  <!-- STEP ONE: Paste this code into the HEAD of your HTML document-->

<head>
  <script language="javascript" type="text/javascript">
  function clock() {
  var date = new Date()
  var year = date.getYear()
  var month = date.getMonth()
  var day = date.getDate()
  var hour = date.getHours()
  var minute = date.getMinutes()
  var second = date.getSeconds()
  var months = new Array("", "JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC")
  var monthname = months[month]
  if (hour > 12) {hour = hour - 12}
  if (minute < 10) {minute = "0" + minute}
  if (second < 10) {second = "0" + second}
  document.title = monthname + " " + day + ", " + year + " - " + hour + ":" + minute + ":" + second
  setTimeout(clock, 1000)
  }
  </script>
  </head>
  
  <!-- STEP TWO: Insert the onLoad event handler into your BODY tag  -->
  
  <body onLoad="clock()">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <div class="form">
    <input type="text" id="firstName" placeholder="First Name">
    <input type="text" id="middleName" placeholder="Middle">
    <input type="text" id="lastName" placeholder="Last Name">
    <input type="text" id="role" placeholder="Assign Role">
    <input type="text" id="salary" placeholder="Set Salary">
    <input type="text" id="department" placeholder="Post Department">
    <button onclick="addEmployee()">Add</button>
  </div>
  <div id="company">

  </div>
  <script>
    companyDb = JSON.parse(localStorage.getItem(("companyTable")))
    if(companyDb == null)
    {
      companyDb = [];
    }
    let addEmployee = () =>
    { // function to add new employee entry
      newEmployee =
        {
          "img" : "img",
          "firstName" : document.getElementById("firstName").value,
          "middleName" : document.getElementById("middleName").value,
          "lastName" : document.getElementById("lastName").value,
          "role" : document.getElementById("role").value,
          "salary" : document.getElementById("salary").value,
          "department" : document.getElementById("department").value,
        }
        companyDb.push(newEmployee)
        localStorage.setItem("companyTable", JSON.stringify(companyDb))
        displayEmployeeRecord()
    }

    let displayEmployeeRecord = () =>
    {
      recordHolder = '';
      for(i=0; i < companyDb.length; i++)
      {
        // if(companyDb[i] != null || companyDb[i] != undefined)
        // {
          recordHolder += `
          <div class="employee" id="${i}">
            <div class="employee_details ${companyDb[i].firstName}profile">
              <img src='${companyDb[i].img}' alt="${companyDb[i].firstName}">
            </div>
            <div class="employee_details ${companyDb[i].fullName}profile">
              <strong>Name</strong>: <span>${companyDb[i].firstName}, ${companyDb[i].middleName} ${companyDb[i].lastName}</span>
            </div>
            <div class="employee_details ${companyDb[i].firstName}profile">
              <strong>Role</strong>: <span>${companyDb[i].role}</span>
            </div>
            <div class="employee_details ${companyDb[i].fullName}profile">
              <strong>Salary</strong>: <span>${companyDb[i].salary}</span>
            </div>
            <div class="employee_details ${companyDb[i].fullName}profile">
              <strong>Department</strong>: <span>${companyDb[i].department}</span>
            </div>
            <div class="btn">
              <button class="del-btn" onClick="delEmployee(${i})">Rusticate</button>
              <button class="edit-btn" onClick="updateEmployeeRecord(${i})">Edit Record</button>
            </div>
          </div>
          `
        };
      // };
      document.getElementById("company").innerHTML = recordHolder;
    };
  displayEmployeeRecord()



  // FUNCTION TO DELETE FROM LOCAL
  let delEmployee = (employeeId) =>
  {
    companyDb.splice(employeeId, 1)
    localStorage.setItem("companyTable", JSON.stringify(companyDb))
    displayEmployeeRecord()
  };


  // FUNCTION TO EDIT EMPLOYEE RECORD
  let updateEmployeeRecord = (employeeId) =>
{
  let updateRecord = 
    {
      "firstName" : prompt("Update First Name:", companyDb[employeeId].firstName),
      "middleName" : prompt("Update Middle Name:", companyDb[employeeId].middleName),
      "lastName" : prompt("Update Last Name:", companyDb[employeeId].lastName),
      "department" : prompt("Change Department (takes effect after 2 working days):", companyDb[employeeId].department),
      "salary" : alert(`Change Salary ${companyDb[employeeId].salary} : "Only HOD can perform this action`),
      "img" : "assets/img/4.jpg",
      "role" : prompt(`Current Role: ${companyDb[employeeId].role}`)
    }
    if(confirm(`
    Confirm Changes
    1.  ${companyDb[employeeId].firstName} to ${updateRecord.firstName}
    2.  ${companyDb[employeeId].department} to ${updateRecord.department}
    3.  ${companyDb[employeeId].role} to ${updateRecord.role}
    `))
    companyDb[employeeId] = updateRecord;
    localStorage.setItem("companyTable", JSON.stringify(companyDb))
    displayEmployeeRecord()
}
  </script>
</body>
</html>